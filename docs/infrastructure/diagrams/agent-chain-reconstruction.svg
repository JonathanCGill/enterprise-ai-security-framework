<svg xmlns="http://www.w3.org/2000/svg" width="820" height="440" viewBox="0 0 820 440" font-family="'Segoe UI', 'Helvetica Neue', Arial, sans-serif">
  <defs>
    <filter id="shadow" x="-2%" y="-2%" width="104%" height="104%">
      <feDropShadow dx="1" dy="1" stdDeviation="2" flood-color="#000" flood-opacity="0.15"/>
    </filter>
  </defs>

  <rect width="820" height="440" rx="8" fill="#0d1117"/>

  <!-- Title -->
  <text x="410" y="30" text-anchor="middle" fill="#e6e6e6" font-size="16" font-weight="700">Agent Decision Chain — Forensic Reconstruction (LOG-04)</text>
  <text x="410" y="48" text-anchor="middle" fill="#8b949e" font-size="10">Every step logged with timestamp, identity, authorization decision, and reasoning</text>

  <!-- Timeline line -->
  <line x1="60" y1="75" x2="60" y2="400" stroke="#30363d" stroke-width="2"/>

  <!-- Step 1: Think -->
  <circle cx="60" cy="85" r="6" fill="#c084fc"/>
  <text x="80" y="82" fill="#c084fc" font-size="11" font-weight="700">Step 1</text>
  <text x="140" y="82" fill="#8b949e" font-size="10">[think]</text>
  <rect x="80" y="88" width="700" height="24" rx="4" fill="#1e1e3f" stroke="#c084fc" stroke-width="0.5"/>
  <text x="92" y="105" fill="#e6e6e6" font-size="10">"User wants to update their billing address"</text>

  <!-- Step 2: Tool call -->
  <circle cx="60" cy="132" r="6" fill="#f0a500"/>
  <text x="80" y="130" fill="#f0a500" font-size="11" font-weight="700">Step 2</text>
  <text x="140" y="130" fill="#8b949e" font-size="10">[tool_call]</text>
  <rect x="80" y="136" width="700" height="24" rx="4" fill="#1a3a5c" stroke="#f0a500" stroke-width="0.5"/>
  <text x="92" y="153" fill="#e6e6e6" font-size="10">customer_db.get_record(customer_id=12345)</text>
  <rect x="550" y="137" width="100" height="22" rx="11" fill="#2d4a1e" stroke="#4ecca3" stroke-width="1"/>
  <text x="600" y="152" text-anchor="middle" fill="#4ecca3" font-size="9" font-weight="600">✅ AUTHORIZED</text>

  <!-- Step 3: Tool result -->
  <circle cx="60" cy="180" r="6" fill="#4ecca3"/>
  <text x="80" y="178" fill="#4ecca3" font-size="11" font-weight="700">Step 3</text>
  <text x="140" y="178" fill="#8b949e" font-size="10">[tool_result]</text>
  <rect x="80" y="184" width="700" height="24" rx="4" fill="#1a3a5c" stroke="#4ecca3" stroke-width="0.5"/>
  <text x="92" y="201" fill="#8b949e" font-size="10">{name: "[PERSON_1]", address: "[REDACTED]", billing: "[REDACTED]"}</text>
  <text x="650" y="201" fill="#f0a500" font-size="9" font-weight="600">LOG-09 redacted</text>

  <!-- Step 4: Think -->
  <circle cx="60" cy="228" r="6" fill="#c084fc"/>
  <text x="80" y="226" fill="#c084fc" font-size="11" font-weight="700">Step 4</text>
  <text x="140" y="226" fill="#8b949e" font-size="10">[think]</text>
  <rect x="80" y="232" width="700" height="24" rx="4" fill="#1e1e3f" stroke="#c084fc" stroke-width="0.5"/>
  <text x="92" y="249" fill="#e6e6e6" font-size="10">"I have the record. I'll update the address field."</text>

  <!-- Step 5: Tool call (needs approval) -->
  <circle cx="60" cy="276" r="6" fill="#f0a500"/>
  <text x="80" y="274" fill="#f0a500" font-size="11" font-weight="700">Step 5</text>
  <text x="140" y="274" fill="#8b949e" font-size="10">[tool_call]</text>
  <rect x="80" y="280" width="700" height="24" rx="4" fill="#2d2a00" stroke="#f0a500" stroke-width="1"/>
  <text x="92" y="297" fill="#e6e6e6" font-size="10">customer_db.update_record(customer_id=12345, field=address, value="...")</text>
  <rect x="550" y="281" width="220" height="22" rx="11" fill="#2d2a00" stroke="#f0a500" stroke-width="1"/>
  <text x="660" y="296" text-anchor="middle" fill="#f0a500" font-size="9" font-weight="600">⏸️ AUTHORIZED — APPROVAL PENDING</text>

  <!-- Step 6: Human approval -->
  <circle cx="60" cy="324" r="6" fill="#e94560"/>
  <text x="80" y="322" fill="#e94560" font-size="11" font-weight="700">Step 6</text>
  <text x="140" y="322" fill="#8b949e" font-size="10">[human_approval]</text>
  <rect x="80" y="328" width="700" height="24" rx="4" fill="#2d4a1e" stroke="#4ecca3" stroke-width="1"/>
  <text x="92" y="345" fill="#4ecca3" font-size="10" font-weight="600">✅ Approved by reviewer@corp.com at 14:23:01Z</text>
  <text x="580" y="345" fill="#8b949e" font-size="9">IAM-05 · identity verified · logged</text>

  <!-- Step 7: Tool result -->
  <circle cx="60" cy="372" r="6" fill="#4ecca3"/>
  <text x="80" y="370" fill="#4ecca3" font-size="11" font-weight="700">Step 7</text>
  <text x="140" y="370" fill="#8b949e" font-size="10">[tool_result]</text>
  <rect x="80" y="376" width="700" height="24" rx="4" fill="#1a3a5c" stroke="#4ecca3" stroke-width="0.5"/>
  <text x="92" y="393" fill="#e6e6e6" font-size="10">Record updated successfully</text>

  <!-- Step 8: Respond -->
  <circle cx="60" cy="418" r="6" fill="#4ecca3"/>
  <text x="80" y="416" fill="#4ecca3" font-size="11" font-weight="700">Step 8</text>
  <text x="140" y="416" fill="#8b949e" font-size="10">[respond]</text>
  <rect x="80" y="418" width="700" height="22" rx="4" fill="#1a3a5c" stroke="#4ecca3" stroke-width="0.5"/>
  <text x="92" y="433" fill="#e6e6e6" font-size="10">"I've updated your billing address to..."</text>

  <!-- Legend dots -->
  <circle cx="30" y="85" r="3" fill="#c084fc" opacity="0.3"/>
  <circle cx="30" y="132" r="3" fill="#f0a500" opacity="0.3"/>
  <circle cx="30" y="180" r="3" fill="#4ecca3" opacity="0.3"/>
  <circle cx="30" y="276" r="3" fill="#f0a500" opacity="0.3"/>
  <circle cx="30" y="324" r="3" fill="#e94560" opacity="0.3"/>
</svg>
