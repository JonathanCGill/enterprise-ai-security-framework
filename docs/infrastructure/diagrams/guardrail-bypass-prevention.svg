<svg xmlns="http://www.w3.org/2000/svg" width="880" height="380" viewBox="0 0 880 380" font-family="'Segoe UI', 'Helvetica Neue', Arial, sans-serif">
  <defs>
    <filter id="shadow" x="-2%" y="-2%" width="104%" height="104%">
      <feDropShadow dx="1" dy="1" stdDeviation="2" flood-color="#000" flood-opacity="0.2"/>
    </filter>
    <marker id="arrowG" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#4ecca3"/>
    </marker>
    <marker id="arrowR" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#e94560"/>
    </marker>
  </defs>

  <rect width="880" height="380" rx="8" fill="#0d1117"/>

  <!-- Title -->
  <text x="440" y="30" text-anchor="middle" fill="#e6e6e6" font-size="18" font-weight="700">Guardrail Bypass Prevention â€” NET-02</text>
  <text x="440" y="50" text-anchor="middle" fill="#8b949e" font-size="11">Network policy enforces guardrail traversal â€” not application routing</text>

  <!-- ===== CORRECT PATH (top) ===== -->
  <text x="40" y="85" fill="#4ecca3" font-size="12" font-weight="700">âœ… CORRECT â€” Network-enforced path</text>

  <!-- Consumer -->
  <rect x="40" y="100" width="110" height="45" rx="5" fill="#1a3a5c" stroke="#4ecca3" stroke-width="1" filter="url(#shadow)"/>
  <text x="95" y="127" text-anchor="middle" fill="#e6e6e6" font-size="10" font-weight="600">Consumer</text>

  <line x1="150" y1="122" x2="185" y2="122" stroke="#4ecca3" stroke-width="2" marker-end="url(#arrowG)"/>

  <!-- API Gateway -->
  <rect x="190" y="100" width="110" height="45" rx="5" fill="#1a3a5c" stroke="#4ecca3" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="245" y="120" text-anchor="middle" fill="#4ecca3" font-size="10" font-weight="600">API Gateway</text>
  <text x="245" y="135" text-anchor="middle" fill="#8b949e" font-size="8">Zone 1</text>

  <line x1="300" y1="122" x2="335" y2="122" stroke="#4ecca3" stroke-width="2" marker-end="url(#arrowG)"/>

  <!-- Input Guardrails -->
  <rect x="340" y="95" width="120" height="55" rx="5" fill="#2d2a00" stroke="#f0a500" stroke-width="2" filter="url(#shadow)"/>
  <text x="400" y="118" text-anchor="middle" fill="#f0a500" font-size="10" font-weight="700">ğŸ›¡ï¸ Input Guard</text>
  <text x="400" y="135" text-anchor="middle" fill="#8b949e" font-size="8">Zone 2 Â· Inline</text>
  <text x="400" y="146" text-anchor="middle" fill="#f0a500" font-size="7">MANDATORY</text>

  <line x1="460" y1="122" x2="495" y2="122" stroke="#4ecca3" stroke-width="2" marker-end="url(#arrowG)"/>

  <!-- Model -->
  <rect x="500" y="100" width="110" height="45" rx="5" fill="#1a3a5c" stroke="#4ecca3" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="555" y="120" text-anchor="middle" fill="#4ecca3" font-size="10" font-weight="600">ğŸ§  Model</text>
  <text x="555" y="135" text-anchor="middle" fill="#8b949e" font-size="8">Zone 2 Â· Internal</text>

  <line x1="610" y1="122" x2="645" y2="122" stroke="#4ecca3" stroke-width="2" marker-end="url(#arrowG)"/>

  <!-- Output Guardrails -->
  <rect x="650" y="95" width="120" height="55" rx="5" fill="#2d2a00" stroke="#f0a500" stroke-width="2" filter="url(#shadow)"/>
  <text x="710" y="118" text-anchor="middle" fill="#f0a500" font-size="10" font-weight="700">ğŸ›¡ï¸ Output Guard</text>
  <text x="710" y="135" text-anchor="middle" fill="#8b949e" font-size="8">Zone 2 Â· Inline</text>
  <text x="710" y="146" text-anchor="middle" fill="#f0a500" font-size="7">MANDATORY</text>

  <line x1="770" y1="122" x2="805" y2="122" stroke="#4ecca3" stroke-width="2" marker-end="url(#arrowG)"/>

  <!-- Response -->
  <rect x="810" y="100" width="50" height="45" rx="5" fill="#2d4a1e" stroke="#4ecca3" stroke-width="1"/>
  <text x="835" y="127" text-anchor="middle" fill="#4ecca3" font-size="10" font-weight="600">âœ…</text>

  <!-- ===== BLOCKED PATH (bottom) ===== -->
  <text x="40" y="205" fill="#e94560" font-size="12" font-weight="700">ğŸš« BLOCKED â€” Direct access attempts denied at network layer</text>

  <!-- Attempt 1: Consumer â†’ Model directly -->
  <rect x="40" y="225" width="110" height="45" rx="5" fill="#1a3a5c" stroke="#e94560" stroke-width="1" filter="url(#shadow)"/>
  <text x="95" y="252" text-anchor="middle" fill="#e6e6e6" font-size="10" font-weight="600">Consumer</text>

  <line x1="150" y1="247" x2="370" y2="247" stroke="#e94560" stroke-width="2" stroke-dasharray="6 3"/>
  <text x="260" y="240" text-anchor="middle" fill="#e94560" font-size="9">Direct to model</text>

  <!-- Block X -->
  <rect x="375" y="230" width="38" height="38" rx="19" fill="#3a1a1a" stroke="#e94560" stroke-width="2"/>
  <text x="394" y="255" text-anchor="middle" fill="#e94560" font-size="16" font-weight="700">âœ—</text>

  <text x="435" y="253" fill="#e94560" font-size="10" font-weight="600">Network policy: model endpoint not routable from Zone 1</text>

  <!-- Attempt 2: Internal component â†’ Model bypassing guardrails -->
  <rect x="40" y="290" width="110" height="45" rx="5" fill="#1a3a5c" stroke="#e94560" stroke-width="1" filter="url(#shadow)"/>
  <text x="95" y="310" text-anchor="middle" fill="#e6e6e6" font-size="10" font-weight="600">Internal Svc</text>
  <text x="95" y="325" text-anchor="middle" fill="#8b949e" font-size="8">Compromised</text>

  <line x1="150" y1="312" x2="370" y2="312" stroke="#e94560" stroke-width="2" stroke-dasharray="6 3"/>
  <text x="260" y="305" text-anchor="middle" fill="#e94560" font-size="9">Bypass guardrails</text>

  <!-- Block X -->
  <rect x="375" y="295" width="38" height="38" rx="19" fill="#3a1a1a" stroke="#e94560" stroke-width="2"/>
  <text x="394" y="320" text-anchor="middle" fill="#e94560" font-size="16" font-weight="700">âœ—</text>

  <text x="435" y="318" fill="#e94560" font-size="10" font-weight="600">Network policy: model accepts traffic only via guardrail service</text>

  <!-- Key principle -->
  <rect x="40" y="345" width="800" height="25" rx="4" fill="#1e1e3f" stroke="#f0a500" stroke-width="1"/>
  <text x="440" y="362" text-anchor="middle" fill="#f0a500" font-size="10" font-weight="600">Key: Guardrail enforcement is network infrastructure, not application routing. Misconfiguration of the app cannot bypass the control.</text>
</svg>
