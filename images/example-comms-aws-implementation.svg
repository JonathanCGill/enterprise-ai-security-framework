<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1100 650" width="1100" height="650">
  <defs>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#64748b"/>
    </marker>
    <marker id="arrow-white" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#ffffff"/>
    </marker>
    
    <!-- Gradients for depth -->
    <linearGradient id="greenGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#22c55e"/>
      <stop offset="100%" style="stop-color:#16a34a"/>
    </linearGradient>
    <linearGradient id="amberGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b"/>
      <stop offset="100%" style="stop-color:#d97706"/>
    </linearGradient>
    <linearGradient id="blueGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#2563eb"/>
    </linearGradient>
  </defs>
  
  <style>
    .title { font: bold 18px Inter, system-ui, sans-serif; fill: #1e293b; }
    .subtitle { font: 12px Inter, system-ui, sans-serif; fill: #64748b; }
    .band-title { font: bold 13px Inter, system-ui, sans-serif; fill: white; }
    .band-time { font: 11px Inter, system-ui, sans-serif; fill: rgba(255,255,255,0.85); }
    .service { font: bold 11px Inter, system-ui, sans-serif; fill: #1e293b; }
    .service-detail { font: 9px Inter, system-ui, sans-serif; fill: #64748b; }
    .outcome { font: bold 10px Inter, system-ui, sans-serif; fill: white; }
    .flow-label { font: 9px Inter, system-ui, sans-serif; fill: #64748b; }
    .feedback-label { font: 9px Inter, system-ui, sans-serif; fill: #64748b; font-style: italic; }
  </style>
  
  <!-- Background -->
  <rect width="1100" height="650" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="550" y="32" text-anchor="middle" class="title">AWS Implementation: Three Time Bands</text>
  <text x="550" y="50" text-anchor="middle" class="subtitle">Control timing matched to message delivery lifecycle</text>
  
  <!-- ============================================== -->
  <!-- BAND A: INLINE -->
  <!-- ============================================== -->
  <rect x="30" y="70" width="340" height="320" rx="12" fill="#22c55e" opacity="0.08"/>
  <rect x="30" y="70" width="340" height="44" rx="12" fill="url(#greenGrad)"/>
  <rect x="30" y="100" width="340" height="14" fill="url(#greenGrad)"/>
  <text x="200" y="94" text-anchor="middle" class="band-title">INLINE</text>
  <text x="200" y="108" text-anchor="middle" class="band-time">~100ms • Prevents before send</text>
  
  <!-- API Gateway -->
  <rect x="50" y="135" width="90" height="45" rx="6" fill="white" stroke="#22c55e" stroke-width="2"/>
  <text x="95" y="157" text-anchor="middle" class="service">API Gateway</text>
  <text x="95" y="170" text-anchor="middle" class="service-detail">Entry point</text>
  
  <!-- Arrow -->
  <line x1="140" y1="157" x2="160" y2="157" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Lambda Router -->
  <rect x="165" y="135" width="90" height="45" rx="6" fill="white" stroke="#22c55e" stroke-width="2"/>
  <text x="210" y="157" text-anchor="middle" class="service">Lambda</text>
  <text x="210" y="170" text-anchor="middle" class="service-detail">Router + Schema</text>
  
  <!-- Arrow -->
  <line x1="255" y1="157" x2="275" y2="157" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Bedrock -->
  <rect x="280" y="130" width="80" height="55" rx="6" fill="white" stroke="#22c55e" stroke-width="2"/>
  <text x="320" y="152" text-anchor="middle" class="service">Bedrock</text>
  <text x="320" y="165" text-anchor="middle" class="service-detail">Guardrails +</text>
  <text x="320" y="176" text-anchor="middle" class="service-detail">Generation</text>
  
  <!-- Arrow down -->
  <line x1="320" y1="185" x2="320" y2="205" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Lambda Output -->
  <rect x="280" y="215" width="80" height="45" rx="6" fill="white" stroke="#22c55e" stroke-width="2"/>
  <text x="320" y="237" text-anchor="middle" class="service">Lambda</text>
  <text x="320" y="250" text-anchor="middle" class="service-detail">Output + DLP</text>
  
  <!-- Arrow down to decision -->
  <line x1="320" y1="260" x2="320" y2="280" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Decision diamond -->
  <polygon points="320,290 355,320 320,350 285,320" fill="white" stroke="#22c55e" stroke-width="2"/>
  <text x="320" y="317" text-anchor="middle" class="service" style="font-size:9px">Auto</text>
  <text x="320" y="328" text-anchor="middle" class="service" style="font-size:9px">Send?</text>
  
  <!-- SEND outcome -->
  <line x1="355" y1="320" x2="380" y2="320" stroke="#22c55e" stroke-width="2"/>
  <text x="368" y="312" class="flow-label">Yes</text>
  <rect x="385" y="305" width="70" height="30" rx="6" fill="#22c55e"/>
  <text x="420" y="324" text-anchor="middle" class="outcome">SEND</text>
  
  <!-- QUEUE outcome -->
  <line x1="285" y1="320" x2="260" y2="320" stroke="#f59e0b" stroke-width="2"/>
  <text x="272" y="312" class="flow-label">No</text>
  <rect x="185" y="305" width="70" height="30" rx="6" fill="#f59e0b"/>
  <text x="220" y="324" text-anchor="middle" class="outcome">QUEUE</text>
  
  <!-- BLOCK outcome -->
  <line x1="320" y1="350" x2="320" y2="365" stroke="#dc2626" stroke-width="2"/>
  <text x="332" y="362" class="flow-label">Block</text>
  <rect x="285" y="370" width="70" height="26" rx="6" fill="#dc2626"/>
  <text x="320" y="388" text-anchor="middle" class="outcome">BLOCKED</text>
  
  <!-- Events flow to Band B -->
  <path d="M 360 237 L 390 237" stroke="#64748b" stroke-width="1.5" stroke-dasharray="4" marker-end="url(#arrow)"/>
  <text x="375" y="228" class="flow-label">Events</text>
  
  <!-- ============================================== -->
  <!-- BAND B: NEAR-REAL-TIME -->
  <!-- ============================================== -->
  <rect x="400" y="70" width="320" height="320" rx="12" fill="#f59e0b" opacity="0.08"/>
  <rect x="400" y="70" width="320" height="44" rx="12" fill="url(#amberGrad)"/>
  <rect x="400" y="100" width="320" height="14" fill="url(#amberGrad)"/>
  <text x="560" y="94" text-anchor="middle" class="band-title">NEAR-REAL-TIME</text>
  <text x="560" y="108" text-anchor="middle" class="band-time">5-30s • Detects drift before scale</text>
  
  <!-- EventBridge -->
  <rect x="420" y="135" width="90" height="45" rx="6" fill="white" stroke="#f59e0b" stroke-width="2"/>
  <text x="465" y="157" text-anchor="middle" class="service">EventBridge</text>
  <text x="465" y="170" text-anchor="middle" class="service-detail">Event router</text>
  
  <!-- Arrow -->
  <line x1="510" y1="157" x2="530" y2="157" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Kinesis -->
  <rect x="535" y="135" width="80" height="45" rx="6" fill="white" stroke="#f59e0b" stroke-width="2"/>
  <text x="575" y="157" text-anchor="middle" class="service">Kinesis</text>
  <text x="575" y="170" text-anchor="middle" class="service-detail">Stream</text>
  
  <!-- Arrow -->
  <line x1="615" y1="157" x2="635" y2="157" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Lambda Aggregator -->
  <rect x="640" y="135" width="70" height="45" rx="6" fill="white" stroke="#f59e0b" stroke-width="2"/>
  <text x="675" y="157" text-anchor="middle" class="service">Lambda</text>
  <text x="675" y="170" text-anchor="middle" class="service-detail">Aggregator</text>
  
  <!-- Fan out lines -->
  <line x1="675" y1="180" x2="675" y2="200" stroke="#f59e0b" stroke-width="2"/>
  <line x1="480" y1="200" x2="680" y2="200" stroke="#f59e0b" stroke-width="2"/>
  <line x1="480" y1="200" x2="480" y2="220" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="560" y1="200" x2="560" y2="220" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="640" y1="200" x2="640" y2="220" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- OpenSearch -->
  <rect x="430" y="230" width="100" height="50" rx="6" fill="white" stroke="#f59e0b" stroke-width="2"/>
  <text x="480" y="252" text-anchor="middle" class="service">OpenSearch</text>
  <text x="480" y="268" text-anchor="middle" class="service-detail">Alert rules</text>
  
  <!-- DynamoDB -->
  <rect x="510" y="300" width="100" height="50" rx="6" fill="white" stroke="#f59e0b" stroke-width="2"/>
  <text x="560" y="322" text-anchor="middle" class="service">DynamoDB</text>
  <text x="560" y="338" text-anchor="middle" class="service-detail">Circuit breakers</text>
  
  <!-- SNS -->
  <rect x="590" y="230" width="100" height="50" rx="6" fill="white" stroke="#f59e0b" stroke-width="2"/>
  <text x="640" y="252" text-anchor="middle" class="service">SNS</text>
  <text x="640" y="268" text-anchor="middle" class="service-detail">PagerDuty alerts</text>
  
  <!-- Arrow from OpenSearch to DynamoDB -->
  <line x1="480" y1="280" x2="520" y2="310" stroke="#f59e0b" stroke-width="1.5" marker-end="url(#arrow)"/>
  
  <!-- Circuit breaker feedback to Band A -->
  <path d="M 510 325 L 455 325 L 455 375 L 360 375 L 360 320 L 355 320" 
        stroke="#f59e0b" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrow)"/>
  <text x="410" y="368" class="feedback-label">Circuit breaker state</text>
  
  <!-- ============================================== -->
  <!-- BAND C: NEARLINE -->
  <!-- ============================================== -->
  <rect x="750" y="70" width="320" height="320" rx="12" fill="#3b82f6" opacity="0.08"/>
  <rect x="750" y="70" width="320" height="44" rx="12" fill="url(#blueGrad)"/>
  <rect x="750" y="100" width="320" height="14" fill="url(#blueGrad)"/>
  <text x="910" y="94" text-anchor="middle" class="band-title">NEARLINE</text>
  <text x="910" y="108" text-anchor="middle" class="band-time">Minutes+ • Improves system over time</text>
  
  <!-- S3 -->
  <rect x="770" y="135" width="80" height="45" rx="6" fill="white" stroke="#3b82f6" stroke-width="2"/>
  <text x="810" y="157" text-anchor="middle" class="service">S3</text>
  <text x="810" y="170" text-anchor="middle" class="service-detail">Message logs</text>
  
  <!-- Arrow -->
  <line x1="850" y1="157" x2="870" y2="157" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Step Functions -->
  <rect x="875" y="135" width="90" height="45" rx="6" fill="white" stroke="#3b82f6" stroke-width="2"/>
  <text x="920" y="152" text-anchor="middle" class="service">Step</text>
  <text x="920" y="164" text-anchor="middle" class="service">Functions</text>
  <text x="920" y="176" text-anchor="middle" class="service-detail">Sampler</text>
  
  <!-- Arrow -->
  <line x1="965" y1="157" x2="985" y2="157" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- Bedrock Judge -->
  <rect x="990" y="135" width="70" height="45" rx="6" fill="white" stroke="#3b82f6" stroke-width="2"/>
  <text x="1025" y="157" text-anchor="middle" class="service">Bedrock</text>
  <text x="1025" y="170" text-anchor="middle" class="service-detail">Judge</text>
  
  <!-- Arrow down -->
  <line x1="1025" y1="180" x2="1025" y2="210" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- OpenSearch Findings -->
  <rect x="975" y="220" width="100" height="45" rx="6" fill="white" stroke="#3b82f6" stroke-width="2"/>
  <text x="1025" y="242" text-anchor="middle" class="service">OpenSearch</text>
  <text x="1025" y="255" text-anchor="middle" class="service-detail">Findings store</text>
  
  <!-- Arrow down -->
  <line x1="1025" y1="265" x2="1025" y2="295" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- QuickSight -->
  <rect x="975" y="305" width="100" height="45" rx="6" fill="white" stroke="#3b82f6" stroke-width="2"/>
  <text x="1025" y="327" text-anchor="middle" class="service">QuickSight</text>
  <text x="1025" y="340" text-anchor="middle" class="service-detail">Dashboards</text>
  
  <!-- Policy Updates box -->
  <rect x="770" y="305" width="120" height="45" rx="6" fill="#3b82f6"/>
  <text x="830" y="325" text-anchor="middle" class="outcome">Policy Updates</text>
  <text x="830" y="340" text-anchor="middle" class="band-time" style="font-size:8px">Guardrails, Prompts</text>
  
  <!-- Arrow from Findings to Policy -->
  <line x1="975" y1="327" x2="895" y2="327" stroke="white" stroke-width="1.5" marker-end="url(#arrow-white)"/>
  
  <!-- Logs flow from Band A to Band C -->
  <path d="M 455 320 L 455 420 L 760 420 L 760 157 L 770 157" 
        stroke="#64748b" stroke-width="1.5" fill="none" stroke-dasharray="4" marker-end="url(#arrow)"/>
  <text x="610" y="435" class="flow-label">Message logs to S3</text>
  
  <!-- Policy feedback to Band A -->
  <path d="M 770 327 L 740 327 L 740 450 L 95 450 L 95 180" 
        stroke="#3b82f6" stroke-width="2" fill="none" stroke-dasharray="5,3" marker-end="url(#arrow)"/>
  <text x="400" y="465" class="feedback-label">Policy updates improve inline controls</text>
  
  <!-- ============================================== -->
  <!-- LEGEND -->
  <!-- ============================================== -->
  <rect x="30" y="500" width="1040" height="140" rx="10" fill="white" stroke="#e2e8f0" stroke-width="1"/>
  
  <text x="550" y="525" text-anchor="middle" class="service" style="font-size:12px">How the Bands Work Together</text>
  
  <!-- Band A summary -->
  <rect x="60" y="545" width="300" height="80" rx="6" fill="#22c55e" opacity="0.1"/>
  <circle cx="80" cy="565" r="10" fill="#22c55e"/>
  <text x="80" y="569" text-anchor="middle" fill="white" style="font:bold 11px sans-serif">A</text>
  <text x="100" y="570" class="service">Inline: Every request</text>
  <text x="70" y="590" class="service-detail">• Guardrails block known-bad instantly</text>
  <text x="70" y="605" class="service-detail">• DLP prevents data leakage</text>
  <text x="70" y="620" class="service-detail">• Decision: send, queue, or block</text>
  
  <!-- Band B summary -->
  <rect x="400" y="545" width="300" height="80" rx="6" fill="#f59e0b" opacity="0.1"/>
  <circle cx="420" cy="565" r="10" fill="#f59e0b"/>
  <text x="420" y="569" text-anchor="middle" fill="white" style="font:bold 11px sans-serif">B</text>
  <text x="440" y="570" class="service">Near-RT: Aggregated signals</text>
  <text x="410" y="590" class="service-detail">• Detects drift within seconds</text>
  <text x="410" y="605" class="service-detail">• Circuit breakers auto-tighten controls</text>
  <text x="410" y="620" class="service-detail">• Alerts ops before problems scale</text>
  
  <!-- Band C summary -->
  <rect x="740" y="545" width="300" height="80" rx="6" fill="#3b82f6" opacity="0.1"/>
  <circle cx="760" cy="565" r="10" fill="#3b82f6"/>
  <text x="760" y="569" text-anchor="middle" fill="white" style="font:bold 11px sans-serif">C</text>
  <text x="780" y="570" class="service">Nearline: Deep analysis</text>
  <text x="750" y="590" class="service-detail">• LLM-as-Judge evaluates quality</text>
  <text x="750" y="605" class="service-detail">• Drift analysis finds patterns</text>
  <text x="750" y="620" class="service-detail">• Policy updates improve Band A</text>
</svg>
