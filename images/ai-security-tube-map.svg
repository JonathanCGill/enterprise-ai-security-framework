<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 1000" width="1400" height="1000">
  <defs>
    <!-- Terminus bar marker -->
    <marker id="terminus" markerWidth="4" markerHeight="16" refX="2" refY="8" orient="auto">
      <rect width="4" height="16" fill="#1e293b"/>
    </marker>
  </defs>
  
  <style>
    .station-name { font: 9px 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif; fill: #1e293b; }
    .interchange-name { font: bold 10px 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif; fill: #1e293b; }
    .interchange-connect { font: italic 7.5px 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif; fill: #64748b; }
    .line-label { font: bold 11px 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif; }
    .title { font: bold 26px 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif; fill: #1e293b; letter-spacing: 2px; }
    .subtitle { font: 13px 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif; fill: #64748b; }
    .legend-text { font: 10px 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif; fill: #1e293b; }
    .legend-heading { font: bold 11px 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif; fill: #1e293b; }
    .terminus-label { font: bold 9px 'Gill Sans', 'Gill Sans MT', Calibri, sans-serif; fill: #1e293b; }
  </style>
  
  <!-- Background -->
  <rect width="1400" height="1000" fill="#f5f5f0"/>
  
  <!-- Title -->
  <text x="700" y="42" text-anchor="middle" class="title">AI SECURITY REFERENCE ARCHITECTURE</text>
  <text x="700" y="62" text-anchor="middle" class="subtitle">Enterprise AI Governance Map — Runtime Behavioral Controls</text>
  
  <!-- ============================================ -->
  <!-- GOVERNANCE LINE (Red) -->
  <!-- AI Policy ——→ Approval Workflow ——→ Risk Acceptance -->
  <!-- ============================================ -->
  <path d="M 90 140 H 420 L 470 190 V 300" stroke="#dc2626" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  
  <!-- Terminus: AI Policy (start) -->
  <rect x="74" y="132" width="6" height="16" rx="1" fill="#1e293b"/>
  <circle cx="90" cy="140" r="5" fill="#dc2626"/>
  <circle cx="90" cy="140" r="2.5" fill="#f5f5f0"/>
  <text x="90" y="126" text-anchor="middle" class="terminus-label">AI Policy</text>
  
  <!-- Governance Structure -->
  <circle cx="170" cy="140" r="5" fill="#dc2626"/>
  <circle cx="170" cy="140" r="2.5" fill="#f5f5f0"/>
  <text x="170" y="126" text-anchor="middle" class="station-name">Governance</text>
  <text x="170" y="158" text-anchor="middle" class="station-name">Structure</text>
  
  <!-- Accountability -->
  <circle cx="250" cy="140" r="5" fill="#dc2626"/>
  <circle cx="250" cy="140" r="2.5" fill="#f5f5f0"/>
  <text x="250" y="126" text-anchor="middle" class="station-name">Accountability</text>
  
  <!-- Committee -->
  <circle cx="340" cy="140" r="5" fill="#dc2626"/>
  <circle cx="340" cy="140" r="2.5" fill="#f5f5f0"/>
  <text x="340" y="126" text-anchor="middle" class="station-name">Committee</text>
  
  <!-- Approval Workflow -->
  <circle cx="420" cy="140" r="5" fill="#dc2626"/>
  <circle cx="420" cy="140" r="2.5" fill="#f5f5f0"/>
  <text x="420" y="126" text-anchor="middle" class="station-name">Approval</text>
  <text x="420" y="158" text-anchor="middle" class="station-name">Workflow</text>
  
  <!-- Terminus: Risk Acceptance (end) -->
  <rect x="462" y="294" width="16" height="6" rx="1" fill="#1e293b"/>
  <circle cx="470" cy="300" r="5" fill="#dc2626"/>
  <circle cx="470" cy="300" r="2.5" fill="#f5f5f0"/>
  <text x="490" y="304" class="terminus-label">Risk Acceptance</text>
  
  <!-- ============================================ -->
  <!-- RISK LINE (Orange) -->
  <!-- Risk Classification ——→ Residual Risk -->
  <!-- ============================================ -->
  <path d="M 90 220 H 290 L 340 270 H 570 L 620 320 H 940" stroke="#f59e0b" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  
  <!-- Terminus: Risk Classification (start) -->
  <rect x="74" y="212" width="6" height="16" rx="1" fill="#1e293b"/>
  <circle cx="90" cy="220" r="5" fill="#f59e0b"/>
  <circle cx="90" cy="220" r="2.5" fill="#f5f5f0"/>
  <text x="90" y="206" text-anchor="middle" class="terminus-label">Risk Classification</text>
  
  <!-- Risk Assessment -->
  <circle cx="170" cy="220" r="5" fill="#f59e0b"/>
  <circle cx="170" cy="220" r="2.5" fill="#f5f5f0"/>
  <text x="170" y="206" text-anchor="middle" class="station-name">Risk</text>
  <text x="170" y="238" text-anchor="middle" class="station-name">Assessment</text>
  
  <!-- Risk Treatment -->
  <circle cx="250" cy="220" r="5" fill="#f59e0b"/>
  <circle cx="250" cy="220" r="2.5" fill="#f5f5f0"/>
  <text x="250" y="206" text-anchor="middle" class="station-name">Risk</text>
  <text x="250" y="238" text-anchor="middle" class="station-name">Treatment</text>
  
  <!-- ★ RISK TIERS — INTERCHANGE (Risk ↔ Development) -->
  <circle cx="340" cy="270" r="14" fill="#ffffff" stroke="#1e293b" stroke-width="3"/>
  <circle cx="340" cy="270" r="8" fill="#ffffff" stroke="#f59e0b" stroke-width="2.5"/>
  <circle cx="340" cy="270" r="4" fill="#1e293b"/>
  <text x="340" y="253" text-anchor="middle" class="interchange-name">RISK TIERS</text>
  <text x="340" y="296" text-anchor="middle" class="interchange-connect">change: Development</text>
  
  <!-- Control Selection -->
  <circle cx="460" cy="270" r="5" fill="#f59e0b"/>
  <circle cx="460" cy="270" r="2.5" fill="#f5f5f0"/>
  <text x="460" y="256" text-anchor="middle" class="station-name">Control</text>
  <text x="460" y="288" text-anchor="middle" class="station-name">Selection</text>
  
  <!-- Sampling Strategy -->
  <circle cx="570" cy="270" r="5" fill="#f59e0b"/>
  <circle cx="570" cy="270" r="2.5" fill="#f5f5f0"/>
  <text x="570" y="256" text-anchor="middle" class="station-name">Sampling</text>
  <text x="570" y="288" text-anchor="middle" class="station-name">Strategy</text>
  
  <!-- Proportionality -->
  <circle cx="780" cy="320" r="5" fill="#f59e0b"/>
  <circle cx="780" cy="320" r="2.5" fill="#f5f5f0"/>
  <text x="780" y="306" text-anchor="middle" class="station-name">Proportionality</text>
  
  <!-- Terminus: Residual Risk (end) -->
  <circle cx="940" cy="320" r="5" fill="#f59e0b"/>
  <circle cx="940" cy="320" r="2.5" fill="#f5f5f0"/>
  <rect x="950" y="312" width="6" height="16" rx="1" fill="#1e293b"/>
  <text x="966" y="324" class="terminus-label">Residual Risk</text>
  
  <!-- ============================================ -->
  <!-- DEVELOPMENT LINE (Blue) -->
  <!-- Requirements ——→ Production Release -->
  <!-- ============================================ -->
  <path d="M 90 380 H 360 L 410 430 H 620 L 670 480 H 720" stroke="#3b82f6" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  
  <!-- Terminus: Requirements (start) -->
  <rect x="74" y="372" width="6" height="16" rx="1" fill="#1e293b"/>
  <circle cx="90" cy="380" r="5" fill="#3b82f6"/>
  <circle cx="90" cy="380" r="2.5" fill="#f5f5f0"/>
  <text x="90" y="366" text-anchor="middle" class="terminus-label">Requirements</text>
  
  <!-- Design -->
  <circle cx="170" cy="380" r="5" fill="#3b82f6"/>
  <circle cx="170" cy="380" r="2.5" fill="#f5f5f0"/>
  <text x="170" y="366" text-anchor="middle" class="station-name">Design</text>
  
  <!-- Development -->
  <circle cx="250" cy="380" r="5" fill="#3b82f6"/>
  <circle cx="250" cy="380" r="2.5" fill="#f5f5f0"/>
  <text x="250" y="366" text-anchor="middle" class="station-name">Development</text>
  
  <!-- Testing -->
  <circle cx="330" cy="380" r="5" fill="#3b82f6"/>
  <circle cx="330" cy="380" r="2.5" fill="#f5f5f0"/>
  <text x="330" y="366" text-anchor="middle" class="station-name">Testing</text>
  
  <!-- ★ VALIDATION — INTERCHANGE (Development ↔ Risk ↔ Compliance) -->
  <circle cx="410" cy="430" r="14" fill="#ffffff" stroke="#1e293b" stroke-width="3"/>
  <circle cx="410" cy="430" r="8" fill="#ffffff" stroke="#3b82f6" stroke-width="2.5"/>
  <circle cx="410" cy="430" r="4" fill="#1e293b"/>
  <text x="410" y="413" text-anchor="middle" class="interchange-name">VALIDATION</text>
  <text x="410" y="456" text-anchor="middle" class="interchange-connect">change: Risk, Compliance</text>
  
  <!-- Security Review -->
  <circle cx="520" cy="430" r="5" fill="#3b82f6"/>
  <circle cx="520" cy="430" r="2.5" fill="#f5f5f0"/>
  <text x="520" y="416" text-anchor="middle" class="station-name">Security</text>
  <text x="520" y="448" text-anchor="middle" class="station-name">Review</text>
  
  <!-- Deployment Approval -->
  <circle cx="620" cy="430" r="5" fill="#3b82f6"/>
  <circle cx="620" cy="430" r="2.5" fill="#f5f5f0"/>
  <text x="620" y="416" text-anchor="middle" class="station-name">Deployment</text>
  <text x="620" y="448" text-anchor="middle" class="station-name">Approval</text>
  
  <!-- Terminus: Production Release (end) -->
  <circle cx="720" cy="480" r="5" fill="#3b82f6"/>
  <circle cx="720" cy="480" r="2.5" fill="#f5f5f0"/>
  <rect x="730" y="472" width="6" height="16" rx="1" fill="#1e293b"/>
  <text x="746" y="484" class="terminus-label">Production Release</text>
  
  <!-- ============================================ -->
  <!-- RUNTIME LINE (Green) — THE MAIN LINE -->
  <!-- Input Guardrails ——→ Action -->
  <!-- ============================================ -->
  <path d="M 210 540 H 520 L 570 590 H 880 L 930 540 H 1200" stroke="#22c55e" stroke-width="10" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  
  <!-- Terminus: Input Guardrails (start) -->
  <rect x="194" y="530" width="6" height="20" rx="1" fill="#1e293b"/>
  <circle cx="210" cy="540" r="6" fill="#22c55e"/>
  <circle cx="210" cy="540" r="3" fill="#f5f5f0"/>
  <text x="210" y="524" text-anchor="middle" class="terminus-label">Input Guardrails</text>
  
  <!-- AI Processing -->
  <circle cx="310" cy="540" r="6" fill="#22c55e"/>
  <circle cx="310" cy="540" r="3" fill="#f5f5f0"/>
  <text x="310" y="524" text-anchor="middle" class="station-name">AI</text>
  <text x="310" y="558" text-anchor="middle" class="station-name">Processing</text>
  
  <!-- Output Guardrails -->
  <circle cx="410" cy="540" r="6" fill="#22c55e"/>
  <circle cx="410" cy="540" r="3" fill="#f5f5f0"/>
  <text x="410" y="524" text-anchor="middle" class="station-name">Output</text>
  <text x="410" y="558" text-anchor="middle" class="station-name">Guardrails</text>
  
  <!-- Logging -->
  <circle cx="520" cy="540" r="6" fill="#22c55e"/>
  <circle cx="520" cy="540" r="3" fill="#f5f5f0"/>
  <text x="520" y="524" text-anchor="middle" class="station-name">Logging</text>
  
  <!-- ★ JUDGE — MAJOR INTERCHANGE (Runtime ↔ Verification ↔ Agentic ↔ Monitoring) -->
  <circle cx="670" cy="590" r="18" fill="#ffffff" stroke="#1e293b" stroke-width="3.5"/>
  <circle cx="670" cy="590" r="12" fill="#ffffff" stroke="#22c55e" stroke-width="2.5"/>
  <circle cx="670" cy="590" r="6" fill="#ffffff" stroke="#06b6d4" stroke-width="2"/>
  <circle cx="670" cy="590" r="3" fill="#1e293b"/>
  <text x="670" y="568" text-anchor="middle" class="interchange-name">JUDGE</text>
  <text x="670" y="620" text-anchor="middle" class="interchange-connect">change: Verification,</text>
  <text x="670" y="631" text-anchor="middle" class="interchange-connect">Monitoring, Agentic</text>
  
  <!-- Evaluation -->
  <circle cx="770" cy="590" r="6" fill="#22c55e"/>
  <circle cx="770" cy="590" r="3" fill="#f5f5f0"/>
  <text x="770" y="574" text-anchor="middle" class="station-name">Evaluation</text>
  
  <!-- Findings -->
  <circle cx="870" cy="590" r="6" fill="#22c55e"/>
  <circle cx="870" cy="590" r="3" fill="#f5f5f0"/>
  <text x="870" y="574" text-anchor="middle" class="station-name">Findings</text>
  
  <!-- ★ HITL — INTERCHANGE (Runtime ↔ Incident) -->
  <circle cx="980" cy="540" r="14" fill="#ffffff" stroke="#1e293b" stroke-width="3"/>
  <circle cx="980" cy="540" r="8" fill="#ffffff" stroke="#22c55e" stroke-width="2.5"/>
  <circle cx="980" cy="540" r="4" fill="#1e293b"/>
  <text x="980" y="523" text-anchor="middle" class="interchange-name">HITL</text>
  <text x="980" y="566" text-anchor="middle" class="interchange-connect">change: Incident</text>
  
  <!-- Human Decision -->
  <circle cx="1080" cy="540" r="6" fill="#22c55e"/>
  <circle cx="1080" cy="540" r="3" fill="#f5f5f0"/>
  <text x="1080" y="524" text-anchor="middle" class="station-name">Human</text>
  <text x="1080" y="558" text-anchor="middle" class="station-name">Decision</text>
  
  <!-- Terminus: Action (end) -->
  <circle cx="1200" cy="540" r="6" fill="#22c55e"/>
  <circle cx="1200" cy="540" r="3" fill="#f5f5f0"/>
  <rect x="1210" y="530" width="6" height="20" rx="1" fill="#1e293b"/>
  <text x="1226" y="544" class="terminus-label">Action</text>
  
  <!-- ============================================ -->
  <!-- AGENTIC LINE (Purple) — Loop from Runtime -->
  <!-- Branches from AI Processing, rejoins at Findings -->
  <!-- ============================================ -->
  <path d="M 310 540 V 610 H 560 L 610 660 H 870 L 920 610 V 540" stroke="#8b5cf6" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  
  <!-- Plan Disclosure (no terminus — loop line) -->
  <circle cx="310" cy="580" r="5" fill="#8b5cf6"/>
  <circle cx="310" cy="580" r="2.5" fill="#f5f5f0"/>
  <text x="270" y="584" text-anchor="end" class="station-name">Plan Disclosure</text>
  
  <!-- Plan Guardrails -->
  <circle cx="310" cy="610" r="5" fill="#8b5cf6"/>
  <circle cx="310" cy="610" r="2.5" fill="#f5f5f0"/>
  <text x="270" y="614" text-anchor="end" class="station-name">Plan Guardrails</text>
  
  <!-- ★ PLAN APPROVAL — INTERCHANGE (Agentic ↔ Verification) -->
  <circle cx="420" cy="610" r="14" fill="#ffffff" stroke="#1e293b" stroke-width="3"/>
  <circle cx="420" cy="610" r="8" fill="#ffffff" stroke="#8b5cf6" stroke-width="2.5"/>
  <circle cx="420" cy="610" r="4" fill="#1e293b"/>
  <text x="420" y="636" text-anchor="middle" class="interchange-name">PLAN APPROVAL</text>
  <text x="420" y="648" text-anchor="middle" class="interchange-connect">change: Verification</text>
  
  <!-- Action Guardrails -->
  <circle cx="520" cy="610" r="5" fill="#8b5cf6"/>
  <circle cx="520" cy="610" r="2.5" fill="#f5f5f0"/>
  <text x="520" y="596" text-anchor="middle" class="station-name">Action</text>
  <text x="520" y="628" text-anchor="middle" class="station-name">Guardrails</text>
  
  <!-- ★ CIRCUIT BREAKERS — INTERCHANGE (Agentic ↔ Monitoring) -->
  <circle cx="720" cy="660" r="14" fill="#ffffff" stroke="#1e293b" stroke-width="3"/>
  <circle cx="720" cy="660" r="8" fill="#ffffff" stroke="#8b5cf6" stroke-width="2.5"/>
  <circle cx="720" cy="660" r="4" fill="#1e293b"/>
  <text x="720" y="686" text-anchor="middle" class="interchange-name">CIRCUIT BREAKERS</text>
  <text x="720" y="698" text-anchor="middle" class="interchange-connect">change: Monitoring</text>
  
  <!-- Scope Enforcement -->
  <circle cx="820" cy="660" r="5" fill="#8b5cf6"/>
  <circle cx="820" cy="660" r="2.5" fill="#f5f5f0"/>
  <text x="820" y="646" text-anchor="middle" class="station-name">Scope</text>
  <text x="820" y="678" text-anchor="middle" class="station-name">Enforcement</text>
  
  <!-- Tool Controls -->
  <circle cx="920" cy="610" r="5" fill="#8b5cf6"/>
  <circle cx="920" cy="610" r="2.5" fill="#f5f5f0"/>
  <text x="958" y="614" class="station-name">Tool Controls</text>
  
  <!-- Trajectory Logging -->
  <circle cx="920" cy="580" r="5" fill="#8b5cf6"/>
  <circle cx="920" cy="580" r="2.5" fill="#f5f5f0"/>
  <text x="958" y="584" class="station-name">Trajectory Logging</text>

  <!-- Loop indicator arrows on Agentic line -->
  <text x="280" y="560" font-size="9" fill="#8b5cf6">↓</text>
  <text x="935" y="560" font-size="9" fill="#8b5cf6">↑</text>
  
  <!-- ============================================ -->
  <!-- VERIFICATION LINE (Cyan) -->
  <!-- (from JUDGE) ——→ Ground Truth Check -->
  <!-- ============================================ -->
  <path d="M 670 590 L 670 660 H 420 L 370 710 H 160" stroke="#06b6d4" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  
  <!-- Token Detection -->
  <circle cx="670" cy="660" r="5" fill="#06b6d4"/>
  <circle cx="670" cy="660" r="2.5" fill="#f5f5f0"/>
  <text x="692" y="664" class="station-name">Token Detection</text>
  
  <!-- Self-Consistency -->
  <circle cx="560" cy="660" r="5" fill="#06b6d4"/>
  <circle cx="560" cy="660" r="2.5" fill="#f5f5f0"/>
  <text x="560" y="646" text-anchor="middle" class="station-name">Self-</text>
  <text x="560" y="678" text-anchor="middle" class="station-name">Consistency</text>
  
  <!-- Knowledge Graph -->
  <circle cx="460" cy="660" r="5" fill="#06b6d4"/>
  <circle cx="460" cy="660" r="2.5" fill="#f5f5f0"/>
  <text x="460" y="646" text-anchor="middle" class="station-name">Knowledge</text>
  <text x="460" y="678" text-anchor="middle" class="station-name">Graph</text>
  
  <!-- ★ VERIFICATION — INTERCHANGE (Verification ↔ Monitoring) -->
  <circle cx="370" cy="710" r="14" fill="#ffffff" stroke="#1e293b" stroke-width="3"/>
  <circle cx="370" cy="710" r="8" fill="#ffffff" stroke="#06b6d4" stroke-width="2.5"/>
  <circle cx="370" cy="710" r="4" fill="#1e293b"/>
  <text x="370" y="693" text-anchor="middle" class="interchange-name">VERIFICATION</text>
  <text x="370" y="736" text-anchor="middle" class="interchange-connect">change: Monitoring</text>
  
  <!-- Formal Verification -->
  <circle cx="260" cy="710" r="5" fill="#06b6d4"/>
  <circle cx="260" cy="710" r="2.5" fill="#f5f5f0"/>
  <text x="260" y="696" text-anchor="middle" class="station-name">Formal</text>
  <text x="260" y="728" text-anchor="middle" class="station-name">Verification</text>
  
  <!-- Terminus: Ground Truth Check (end) -->
  <circle cx="160" cy="710" r="5" fill="#06b6d4"/>
  <circle cx="160" cy="710" r="2.5" fill="#f5f5f0"/>
  <rect x="144" y="702" width="6" height="16" rx="1" fill="#1e293b"/>
  <text x="160" y="696" text-anchor="middle" class="terminus-label">Ground Truth</text>
  <text x="160" y="730" text-anchor="middle" class="terminus-label">Check</text>
  
  <!-- ============================================ -->
  <!-- MONITORING LINE (Teal) -->
  <!-- (from Logging) ——→ Pattern Discovery -->
  <!-- ============================================ -->
  <path d="M 520 540 V 790 H 920 L 970 740" stroke="#0d9488" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  
  <!-- Event Stream -->
  <circle cx="520" cy="640" r="5" fill="#0d9488"/>
  <circle cx="520" cy="640" r="2.5" fill="#f5f5f0"/>
  <text x="500" y="644" text-anchor="end" class="station-name">Event Stream</text>
  
  <!-- Alert Store -->
  <circle cx="520" cy="740" r="5" fill="#0d9488"/>
  <circle cx="520" cy="740" r="2.5" fill="#f5f5f0"/>
  <text x="500" y="744" text-anchor="end" class="station-name">Alert Store</text>
  
  <!-- ★ AGGREGATION — INTERCHANGE (Monitoring ↔ Incident) -->
  <circle cx="520" cy="790" r="14" fill="#ffffff" stroke="#1e293b" stroke-width="3"/>
  <circle cx="520" cy="790" r="8" fill="#ffffff" stroke="#0d9488" stroke-width="2.5"/>
  <circle cx="520" cy="790" r="4" fill="#1e293b"/>
  <text x="520" y="816" text-anchor="middle" class="interchange-name">AGGREGATION</text>
  <text x="520" y="828" text-anchor="middle" class="interchange-connect">change: Incident</text>
  
  <!-- Correlation -->
  <circle cx="670" cy="790" r="5" fill="#0d9488"/>
  <circle cx="670" cy="790" r="2.5" fill="#f5f5f0"/>
  <text x="670" y="810" text-anchor="middle" class="station-name">Correlation</text>
  
  <!-- ★ ML ANOMALY — INTERCHANGE (Monitoring ↔ Incident) -->
  <circle cx="820" cy="790" r="14" fill="#ffffff" stroke="#1e293b" stroke-width="3"/>
  <circle cx="820" cy="790" r="8" fill="#ffffff" stroke="#0d9488" stroke-width="2.5"/>
  <circle cx="820" cy="790" r="4" fill="#1e293b"/>
  <text x="820" y="816" text-anchor="middle" class="interchange-name">ML ANOMALY</text>
  <text x="820" y="828" text-anchor="middle" class="interchange-connect">change: Incident</text>
  
  <!-- Drift Detection -->
  <circle cx="920" cy="790" r="5" fill="#0d9488"/>
  <circle cx="920" cy="790" r="2.5" fill="#f5f5f0"/>
  <text x="920" y="810" text-anchor="middle" class="station-name">Drift Detection</text>
  
  <!-- Terminus: Pattern Discovery (end) -->
  <circle cx="970" cy="740" r="5" fill="#0d9488"/>
  <circle cx="970" cy="740" r="2.5" fill="#f5f5f0"/>
  <rect x="976" y="732" width="6" height="16" rx="1" fill="#1e293b"/>
  <text x="992" y="744" class="terminus-label">Pattern Discovery</text>
  
  <!-- ============================================ -->
  <!-- COMPLIANCE LINE (Yellow) — CIRCLE LINE -->
  <!-- No terminus — continuous loop -->
  <!-- ============================================ -->
  <path d="M 740 140 H 1200 V 380 H 740 V 140" stroke="#eab308" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  
  <!-- Direction arrows on circle line -->
  <text x="960" y="133" font-size="12" fill="#eab308" text-anchor="middle">→ →</text>
  <text x="960" y="395" font-size="12" fill="#eab308" text-anchor="middle">← ←</text>
  
  <!-- ISO 27001 -->
  <circle cx="740" cy="140" r="5" fill="#eab308"/>
  <circle cx="740" cy="140" r="2.5" fill="#f5f5f0"/>
  <text x="740" y="126" text-anchor="middle" class="station-name">ISO 27001</text>
  
  <!-- ISO 42001 -->
  <circle cx="880" cy="140" r="5" fill="#eab308"/>
  <circle cx="880" cy="140" r="2.5" fill="#f5f5f0"/>
  <text x="880" y="126" text-anchor="middle" class="station-name">ISO 42001</text>
  
  <!-- EU AI Act -->
  <circle cx="1040" cy="140" r="5" fill="#eab308"/>
  <circle cx="1040" cy="140" r="2.5" fill="#f5f5f0"/>
  <text x="1040" y="126" text-anchor="middle" class="station-name">EU AI Act</text>
  
  <!-- SR 11-7 -->
  <circle cx="1200" cy="140" r="5" fill="#eab308"/>
  <circle cx="1200" cy="140" r="2.5" fill="#f5f5f0"/>
  <text x="1200" y="126" text-anchor="middle" class="station-name">SR 11-7</text>
  
  <!-- NIST AI RMF -->
  <circle cx="1200" cy="260" r="5" fill="#eab308"/>
  <circle cx="1200" cy="260" r="2.5" fill="#f5f5f0"/>
  <text x="1182" y="264" text-anchor="end" class="station-name">NIST AI RMF</text>
  
  <!-- OWASP -->
  <circle cx="1200" cy="380" r="5" fill="#eab308"/>
  <circle cx="1200" cy="380" r="2.5" fill="#f5f5f0"/>
  <text x="1182" y="384" text-anchor="end" class="station-name">OWASP</text>
  
  <!-- MITRE ATLAS -->
  <circle cx="960" cy="380" r="5" fill="#eab308"/>
  <circle cx="960" cy="380" r="2.5" fill="#f5f5f0"/>
  <text x="960" y="398" text-anchor="middle" class="station-name">MITRE ATLAS</text>
  
  <!-- Audit -->
  <circle cx="740" cy="380" r="5" fill="#eab308"/>
  <circle cx="740" cy="380" r="2.5" fill="#f5f5f0"/>
  <text x="740" y="398" text-anchor="middle" class="station-name">Audit</text>
  
  <!-- Documentation -->
  <circle cx="740" cy="260" r="5" fill="#eab308"/>
  <circle cx="740" cy="260" r="2.5" fill="#f5f5f0"/>
  <text x="756" y="264" class="station-name">Documentation</text>
  
  <!-- Circle line indicator -->
  <text x="970" y="266" text-anchor="middle" font-size="8" fill="#eab308" font-weight="bold" font-family="'Gill Sans', 'Gill Sans MT', Calibri, sans-serif">● CIRCLE LINE — NO TERMINUS</text>
  
  <!-- ============================================ -->
  <!-- INCIDENT LINE (Pink) -->
  <!-- Detection ——→ Policy Update (feeds back) -->
  <!-- ============================================ -->
  <path d="M 1100 540 L 1100 850 H 160 V 220" stroke="#ec4899" stroke-width="8" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
  
  <!-- Detection -->
  <circle cx="1100" cy="640" r="5" fill="#ec4899"/>
  <circle cx="1100" cy="640" r="2.5" fill="#f5f5f0"/>
  <text x="1120" y="644" class="station-name">Detection</text>
  
  <!-- Response -->
  <circle cx="1100" cy="740" r="5" fill="#ec4899"/>
  <circle cx="1100" cy="740" r="2.5" fill="#f5f5f0"/>
  <text x="1120" y="744" class="station-name">Response</text>
  
  <!-- ★ INCIDENT RESPONSE — INTERCHANGE (Incident ↔ Monitoring) -->
  <circle cx="1100" cy="850" r="14" fill="#ffffff" stroke="#1e293b" stroke-width="3"/>
  <circle cx="1100" cy="850" r="8" fill="#ffffff" stroke="#ec4899" stroke-width="2.5"/>
  <circle cx="1100" cy="850" r="4" fill="#1e293b"/>
  <text x="1100" y="876" text-anchor="middle" class="interchange-name">INCIDENT RESPONSE</text>
  <text x="1100" y="888" text-anchor="middle" class="interchange-connect">change: Monitoring</text>
  
  <!-- Investigation -->
  <circle cx="880" cy="850" r="5" fill="#ec4899"/>
  <circle cx="880" cy="850" r="2.5" fill="#f5f5f0"/>
  <text x="880" y="868" text-anchor="middle" class="station-name">Investigation</text>
  
  <!-- Remediation -->
  <circle cx="670" cy="850" r="5" fill="#ec4899"/>
  <circle cx="670" cy="850" r="2.5" fill="#f5f5f0"/>
  <text x="670" y="868" text-anchor="middle" class="station-name">Remediation</text>
  
  <!-- ★ FEEDBACK LOOP — MAJOR INTERCHANGE (Incident ↔ Runtime ↔ Governance) -->
  <circle cx="370" cy="850" r="18" fill="#ffffff" stroke="#1e293b" stroke-width="3.5"/>
  <circle cx="370" cy="850" r="12" fill="#ffffff" stroke="#ec4899" stroke-width="2.5"/>
  <circle cx="370" cy="850" r="6" fill="#ffffff" stroke="#dc2626" stroke-width="2"/>
  <circle cx="370" cy="850" r="3" fill="#1e293b"/>
  <text x="370" y="833" text-anchor="middle" class="interchange-name">FEEDBACK LOOP</text>
  <text x="370" y="880" text-anchor="middle" class="interchange-connect">change: Governance,</text>
  <text x="370" y="891" text-anchor="middle" class="interchange-connect">Runtime</text>
  
  <!-- Guardrail Update -->
  <circle cx="160" cy="850" r="5" fill="#ec4899"/>
  <circle cx="160" cy="850" r="2.5" fill="#f5f5f0"/>
  <text x="160" y="868" text-anchor="middle" class="station-name">Guardrail Update</text>
  
  <!-- Judge Calibration -->
  <circle cx="160" cy="540" r="5" fill="#ec4899"/>
  <circle cx="160" cy="540" r="2.5" fill="#f5f5f0"/>
  <text x="140" y="544" text-anchor="end" class="station-name">Judge Calibration</text>
  
  <!-- Policy Update -->
  <circle cx="160" cy="380" r="5" fill="#ec4899"/>
  <circle cx="160" cy="380" r="2.5" fill="#f5f5f0"/>
  <text x="140" y="384" text-anchor="end" class="station-name">Policy Update</text>
  
  <!-- Terminus: back to Risk/Governance area — feeds learning back -->
  <circle cx="160" cy="220" r="5" fill="#ec4899"/>
  <circle cx="160" cy="220" r="2.5" fill="#f5f5f0"/>
  <rect x="152" y="204" width="16" height="6" rx="1" fill="#1e293b"/>
  <text x="160" y="198" text-anchor="middle" class="terminus-label">← feeds back to</text>
  <text x="160" y="188" text-anchor="middle" class="terminus-label">Governance &amp; Risk</text>
  
  <!-- ============================================ -->
  <!-- LEGEND — Expanded with visual key -->
  <!-- ============================================ -->
  <rect x="30" y="900" width="1340" height="90" rx="8" fill="#ffffff" stroke="#d4d4d4" stroke-width="1.5"/>
  
  <!-- Lines section -->
  <text x="50" y="920" class="legend-heading">LINES</text>
  
  <line x1="50" y1="935" x2="80" y2="935" stroke="#dc2626" stroke-width="4"/>
  <text x="88" y="939" class="legend-text">Governance</text>
  
  <line x1="50" y1="953" x2="80" y2="953" stroke="#f59e0b" stroke-width="4"/>
  <text x="88" y="957" class="legend-text">Risk</text>
  
  <line x1="50" y1="971" x2="80" y2="971" stroke="#3b82f6" stroke-width="4"/>
  <text x="88" y="975" class="legend-text">Development</text>
  
  <line x1="180" y1="935" x2="210" y2="935" stroke="#22c55e" stroke-width="5"/>
  <text x="218" y="939" class="legend-text">Runtime (main line)</text>
  
  <line x1="180" y1="953" x2="210" y2="953" stroke="#8b5cf6" stroke-width="4"/>
  <text x="218" y="957" class="legend-text">Agentic (loop)</text>
  
  <line x1="180" y1="971" x2="210" y2="971" stroke="#06b6d4" stroke-width="4"/>
  <text x="218" y="975" class="legend-text">Verification</text>
  
  <line x1="340" y1="935" x2="370" y2="935" stroke="#0d9488" stroke-width="4"/>
  <text x="378" y="939" class="legend-text">Monitoring</text>
  
  <line x1="340" y1="953" x2="370" y2="953" stroke="#eab308" stroke-width="4"/>
  <text x="378" y="957" class="legend-text">Compliance (circle)</text>
  
  <line x1="340" y1="971" x2="370" y2="971" stroke="#ec4899" stroke-width="4"/>
  <text x="378" y="975" class="legend-text">Incident (feedback)</text>
  
  <!-- Symbols section -->
  <line x1="510" y1="918" x2="510" y2="980" stroke="#d4d4d4" stroke-width="1"/>
  <text x="530" y="920" class="legend-heading">SYMBOLS</text>
  
  <!-- Regular station -->
  <circle cx="540" cy="938" r="5" fill="#64748b"/>
  <circle cx="540" cy="938" r="2.5" fill="#f5f5f0"/>
  <text x="553" y="942" class="legend-text">Station</text>
  
  <!-- Interchange -->
  <circle cx="540" cy="958" r="9" fill="#ffffff" stroke="#1e293b" stroke-width="2"/>
  <circle cx="540" cy="958" r="5" fill="#ffffff" stroke="#64748b" stroke-width="1.5"/>
  <circle cx="540" cy="958" r="2.5" fill="#1e293b"/>
  <text x="553" y="962" class="legend-text">Interchange — change lines here</text>
  
  <!-- Terminus -->
  <rect x="535" y="971" width="5" height="12" rx="1" fill="#1e293b"/>
  <circle cx="548" cy="977" r="5" fill="#64748b"/>
  <circle cx="548" cy="977" r="2.5" fill="#f5f5f0"/>
  <text x="560" y="981" class="legend-text">Terminus — start or end of line</text>
  
  <!-- Reading guide section -->
  <line x1="760" y1="918" x2="760" y2="980" stroke="#d4d4d4" stroke-width="1"/>
  <text x="780" y="920" class="legend-heading">HOW TO READ THIS MAP</text>
  
  <text x="780" y="938" class="legend-text">Start at a terminus on any line. Follow the line through stations.</text>
  <text x="780" y="953" class="legend-text">At an interchange (⊕), you can switch to another line.</text>
  <text x="780" y="968" class="legend-text">The Runtime line (green, thicker) is the main operational path.</text>
  <text x="780" y="983" class="legend-text">The Incident line (pink) feeds lessons back to Governance — the system learns.</text>
  
  <!-- Roundel logo -->
  <circle cx="1300" cy="950" r="28" fill="none" stroke="#1e40af" stroke-width="6"/>
  <rect x="1258" y="941" width="84" height="18" rx="2" fill="#1e40af"/>
  <text x="1300" y="954" text-anchor="middle" font-size="9" font-weight="bold" fill="#ffffff" font-family="'Gill Sans', 'Gill Sans MT', Calibri, sans-serif">AI SECURITY</text>
</svg>
